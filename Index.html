<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8J5398GPX0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8J5398GPX0');
</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>$Ai Airdrop</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f8fc;
      padding: 20px;
      max-width: 800px;
      margin: auto;
      color: #111;
    }
    .language-switcher {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin-bottom: 20px;
    }
    .language-item {
      cursor: pointer;
      text-align: center;
      font-size: 12px;
    }
    .language-item img {
      width: 32px;
      height: 32px;
      border: 2px solid transparent;
      border-radius: 8px; /* квадрат с мягкими углами */
      object-fit: cover;
    }
    .language-item.active img {
      border-color: #007bff;
    }
    input, button {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background: #007bff;
      color: #fff;
      font-weight: bold;
      border: none;
      cursor: pointer;
      margin-top: 10px;
    }
    #status {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="language-switcher">
    <div class="language-item" data-lang="ru">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreichi6m3nticagnplr75b7v5wjjmz3ev2paqjktkqre4x5ptcabjzi" alt="RU">
      <div>RU</div>
    </div>
    <div class="language-item" data-lang="en">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreid3krlcmab7md4673w5zzsrsfyim4m4ly3lkx57lfbrngtjpvjmue" alt="EN">
      <div>EN</div>
    </div>
    <div class="language-item" data-lang="de">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreibeoajvluupgnywudnnbwwnfzsndh4t6p5bekk4sfk4u3tuizlwwq" alt="DE">
      <div>DE</div>
    </div>
    <div class="language-item" data-lang="fr">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreibxbh6euliqx2psfdldpxolctfv2ls3t6r772i5tvake7d3q53hgi" alt="FR">
      <div>FR</div>
    </div>
    <div class="language-item" data-lang="es">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreibtewx6m353ch74sfxpyelddqu433wjntulxfkgzetx2etcl2g4ri" alt="ES">
      <div>ES</div>
    </div>
    <div class="language-item" data-lang="it">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreihfxgxfwumvyellx5qcbsh6sjo2vg7eao2jtivwxxpa6zypj66cw4" alt="IT">
      <div>IT</div>
    </div>
    <div class="language-item" data-lang="ar">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreibocrulvp7uionw7vwkelg7cdmcasqmgoiu5utq4lbe4solruu62i" alt="AR">
      <div>AR</div>
    </div>
    <div class="language-item" data-lang="zh">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreibk7jdtxhh2oudweqvaeevgjf6em4fsmnhj4x5vlpog3se42dy7zy" alt="ZH">
      <div>ZH</div>
    </div>
    <div class="language-item" data-lang="ja">
      <img src="https://gateway.pinata.cloud/ipfs/bafkreiggbwrwhq5liojwzhbsdqhuk6d32fm7x5ndwdz5emrsxrzheszheq" alt="JA">
      <div>JA</div>
    </div>
  </div>

  <h2 data-i18n="form_title">Форма участия в Airdrop</h2>
  <form id="airdropForm">
    <label data-i18n="label_twitter">Twitter (X) ник (без @):</label>
    <input type="text" name="twitter" required>
    <label data-i18n="label_retweet">Ссылка на ретвит:</label>
    <input type="url" name="retweet" required>
    <label data-i18n="label_wallet">Адрес кошелька:</label>
    <input type="text" name="wallet" required>
    <label data-i18n="label_email">Email (необязательно):</label>
    <input type="email" name="email">
    <button type="submit" data-i18n="button_submit">Участвовать</button>
    <div id="status"></div>
  </form>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzy_QF4Px5xoCwD_LXlpTH7ENnV7_cMPCE3sSsQQ_BMt3FtB1TsWSSSQ94uE9WU_nM/exec';
    const langs = Array.from(document.querySelectorAll('.language-item'));
    let translations = {};

    const langDocLinks = {
      ru: "https://gateway.pinata.cloud/ipfs/bafkreichi6m3nticagnplr75b7v5wjjmz3ev2paqjktkqre4x5ptcabjzi",
      en: "https://gateway.pinata.cloud/ipfs/bafkreid3krlcmab7md4673w5zzsrsfyim4m4ly3lkx57lfbrngtjpvjmue",
      fr: "https://gateway.pinata.cloud/ipfs/bafkreibxbh6euliqx2psfdldpxolctfv2ls3t6r772i5tvake7d3q53hgi",
      de: "https://gateway.pinata.cloud/ipfs/bafkreibeoajvluupgnywudnnbwwnfzsndh4t6p5bekk4sfk4u3tuizlwwq",
      es: "https://gateway.pinata.cloud/ipfs/bafkreibtewx6m353ch74sfxpyelddqu433wjntulxfkgzetx2etcl2g4ri",
      it: "https://gateway.pinata.cloud/ipfs/bafkreihfxgxfwumvyellx5qcbsh6sjo2vg7eao2jtivwxxpa6zypj66cw4",
      ar: "https://gateway.pinata.cloud/ipfs/bafkreibocrulvp7uionw7vwkelg7cdmcasqmgoiu5utq4lbe4solruu62i",
      zh: "https://gateway.pinata.cloud/ipfs/bafkreibk7jdtxhh2oudweqvaeevgjf6em4fsmnhj4x5vlpog3se42dy7zy",
      ja: "https://gateway.pinata.cloud/ipfs/bafkreiggbwrwhq5liojwzhbsdqhuk6d32fm7x5ndwdz5emrsxrzheszheq"
    };

    function setActiveLang(lang) {
      langs.forEach(el => el.classList.toggle('active', el.dataset.lang === lang));
    }

    langs.forEach(el => el.addEventListener('click', () => {
      const chosen = el.dataset.lang;
      localStorage.setItem('lang', chosen);
      init();
    }));

    async function loadTranslations(lang) {
      const res = await fetch(`./lang/${lang}.json`);
      return await res.json();
    }

    function applyTranslations() {
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[key]) el.innerText = translations[key];
      });
    }

    function generateLinksJSON() {
      const lang = localStorage.getItem('lang') || 'ru';
      return {
        doc: langDocLinks[lang] || "",
        telegram: translations['telegram_link'] || "",
        website: translations['website_link'] || ""
      };
    }

    async function init() {
      const lang = localStorage.getItem('lang') || 'ru';
      setActiveLang(lang);
      translations = await loadTranslations(lang);
      applyTranslations();
    }

    document.addEventListener('DOMContentLoaded', init);

    document.getElementById('airdropForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.currentTarget);
      const lang = localStorage.getItem('lang') || 'ru';
      formData.append('lang', lang);
      formData.append('links_json', JSON.stringify(generateLinksJSON()));

      const status = document.getElementById('status');
      try {
        const resp = await fetch(scriptURL, { method: 'POST', body: formData });
        const text = await resp.text();
        const ok = text.includes('"result":"success"');
        status.innerText = ok ? '✅ ' + (translations['success_msg'] || 'Успешно отправлено!') : '❌ ' + (translations['error_msg'] || 'Ошибка. Попробуйте позже.');
        status.style.color = ok ? 'green' : 'red';
      } catch {
        status.innerText = '❌ ' + (translations['network_error'] || 'Сетевая ошибка.');
        status.style.color = 'red';
      }
    });
  </script>
</body>
</html>
